(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(r){if(r.ep)return;r.ep=!0;const t=o(r);fetch(r.href,t)}})();const _="8c6809504e25cdd6896385597447d077",y=(e,n)=>({weather:`https://api.openweathermap.org/data/2.5/${n.type}?lat=${n.lat}&lon=${n.lon}&appid=${e}&units=${n.units}`,geo:`https://api.openweathermap.org/geo/1.0/direct?q=${n}&limit=1&appid=${e}`}),p=async e=>{try{const n=await fetch(e,{mode:"cors"});if(n.status===200)return await n.json();console.log("Server error: ",n)}catch(n){console.log(`Error: in function ${p.name}
${n}`)}},$=async(e,n,o,a)=>await e(n(o,a).geo),w=async(e,n,o,a)=>await e(n(o,a).weather),S=(e,n)=>n.filter(o=>e.includes(o.dt_txt)),b=e=>parseFloat((Math.round(e*10)/10).toFixed(1)),h=(e,n)=>{const o=new Date,a=t=>("0"+t).slice(-2),r=()=>{let t=`${o.getFullYear()}-${a(o.getMonth()+1)}-${a(o.getDate())}`;return n&&(t=t+` ${n}:00:00`),t};if(e){const t=[];for(let i=0;i<e;i++)o.setDate(o.getDate()+1),t.push(r());return t}return r()},x=(e,n)=>{const o=[],a=t=>Math.max(...t.map(i=>i.main.temp_max)),r=t=>Math.min(...t.map(i=>i.main.temp_min));return n.forEach(t=>{const i=e.list.filter(m=>m.dt_txt.slice(0,10)==t);o.push({max:a(i),min:r(i)})}),o},q=(e,n)=>{const o=[],a=r=>Math.max(...r.map(t=>t.main.humidity));return n.forEach(r=>{const t=e.list.filter(i=>i.dt_txt.slice(0,10)==r);o.push(a(t))}),o},D=()=>document.querySelector(".location-search__input").value,T=e=>{document.querySelector(".location-search__button").addEventListener("click",()=>e())},E=e=>{document.querySelector(".unit-selection__button").addEventListener("click",()=>e())},O=async()=>{const e={lat:"lat",lon:"lon",country:"country",state:"state",name:"name"},n=await $(p,y,_,D());return g(e,{...n[0]})},g=(e,n)=>{const o={};return Object.keys(e).map(a=>{n[e[a]]&&(o[a]=n[e[a]])}),o},L=(e,n,o)=>{const a={lat:e,lon:n,units:o.units},r=(l,s)=>{const u={details:{temp:"temp",humidity:"humidity"},weather:{state:"main",desc:"description",icon:"icon"}},c={details:g(u.details,{...l.main}),weather:g(u.weather,{...l.weather[0]})};return s&&(c.date=new Date(Date.parse(l.dt_txt)).toLocaleString("default",{weekday:"long"})),c},t=(l,s,u)=>(s.forEach((c,d)=>{l[d].details.tempMax=c.max,l[d].details.tempMin=c.min,u&&(l[d].details.humidity=u[d])}),l);return{current:async()=>{a.type="weather";const l=await w(p,y,_,a);a.type="forecast";const s=await w(p,y,_,a),u=x(s,[h()]);let c=r(l);return c=t([c],u),c},forecast:async()=>{a.type="forecast";const l=await w(p,y,_,a),s=S(h(3,12),l.list),u=x(l,h(3)),c=q(l,h(3));let d=[];return s.forEach(f=>d.push(r(f,!0))),d=t(d,u,c),d}}},v=async()=>{const e={units:"metric",symbol:{metric:"°C",imperial:"°F",humidity:"%"}},n=t=>{t.units==="metric"?t.units="imperial":e.units="metric",document.querySelector(".unit-selection__button").innerHTML=t.symbol[t.units]},o=(t,i)=>{const m=async(s,u)=>{const c=new Image;return c.src=`https://openweathermap.org/img/wn/${s}@${u}x.png`,await c.decode(),c.src},l=async(s,u)=>{const c=document.querySelector(`.weather__info.${u}`),d=M=>`${b(M)}${e.symbol[e.units]}`;let f=2;c.querySelector(".weather__info__text__temp-max").innerHTML='<i class="fa-solid fa-caret-up"></i> '+d(s.details.tempMax),c.querySelector(".weather__info__text__temp-low").innerHTML='<i class="fa-solid fa-caret-down"></i> '+d(s.details.tempMin),c.querySelector(".weather__info__text__humidity").innerHTML='<i class="fa-solid fa-droplet"></i> '+s.details.humidity+e.symbol.humidity,u==="current"?(f=4,c.querySelector(".weather__info__text__temp").innerHTML=d(s.details.temp),c.querySelector(".weather__info__desc__weather").innerHTML=s.weather.state,c.querySelector(".weather__info__desc__img").src=await m(s.weather.icon,f)):(c.querySelector(".weather__info__day").innerHTML=s.date,c.querySelector(".weather__info__img").src=await m(s.weather.icon,f))};l(t,"current"),i.forEach((s,u)=>l(s,`day${u+1}`)),document.querySelector(".weather__container").style.display="grid"},a=t=>{document.querySelector(".location-search__input").value=`${t.name}, ${t.state}`},r=async()=>{const t=await O(),i=await L(t.lat,t.lon,e).current(),m=await L(t.lat,t.lon,e).forecast();a(t),o(...i,m)};E(()=>n(e)),T(r)};v();
