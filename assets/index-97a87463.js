(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const _="8c6809504e25cdd6896385597447d077",y=(e,t)=>({weather:`https://api.openweathermap.org/data/2.5/${t.type}?lat=${t.lat}&lon=${t.lon}&appid=${e}&units=${t.units}`,geo:`https://api.openweathermap.org/geo/1.0/direct?q=${t}&limit=1&appid=${e}`}),p=async e=>{try{const t=await fetch(e,{mode:"cors"});if(t.status===200)return await t.json();console.log("Server error: ",t)}catch(t){console.log(`Error: in function ${p.name}
${t}`)}},S=async(e,t,a,i)=>await e(t(a,i).geo),w=async(e,t,a,i)=>await e(t(a,i).weather),b=(e,t)=>t.filter(a=>e.includes(a.dt_txt)),q=e=>parseFloat((Math.round(e*10)/10).toFixed(1)),h=(e,t)=>{const a=new Date,i=n=>("0"+n).slice(-2),o=()=>{let n=`${a.getFullYear()}-${i(a.getMonth()+1)}-${i(a.getDate())}`;return t&&(n=n+` ${t}:00:00`),n};if(e){const n=[];for(let r=0;r<e;r++)a.setDate(a.getDate()+1),n.push(o());return n}return o()},L=(e,t)=>{const a=[],i=n=>Math.max(...n.map(r=>r.main.temp_max)),o=n=>Math.min(...n.map(r=>r.main.temp_min));return t.forEach(n=>{const r=e.list.filter(m=>m.dt_txt.slice(0,10)==n);a.push({max:i(r),min:o(r)})}),a},D=(e,t)=>{const a=[],i=o=>Math.max(...o.map(n=>n.main.humidity));return t.forEach(o=>{const n=e.list.filter(r=>r.dt_txt.slice(0,10)==o);a.push(i(n))}),a},T=()=>document.querySelector(".location-search__input").value,E=e=>{document.querySelector(".location-search__button").addEventListener("click",()=>e())},O=e=>{document.querySelector(".unit-selection__button").addEventListener("click",()=>e())},W=async()=>{const e={lat:"lat",lon:"lon",country:"country",state:"state",name:"name"},t=await S(p,y,_,T());return x(e,{...t[0]})},x=(e,t)=>{const a={};return Object.keys(e).map(i=>{t[e[i]]&&(a[i]=t[e[i]])}),a},M=(e,t,a)=>{const i={lat:e,lon:t,units:a.units},o=(s,d)=>{const c={details:{temp:"temp",humidity:"humidity"},weather:{state:"main",desc:"description",icon:"icon"}},u={details:x(c.details,{...s.main}),weather:x(c.weather,{...s.weather[0]})};return d&&(u.date=new Date(Date.parse(s.dt_txt)).toLocaleString("default",{weekday:"long"})),u},n=(s,d,c)=>(d.forEach((u,l)=>{s[l].details.tempMax=u.max,s[l].details.tempMin=u.min,c&&(s[l].details.humidity=c[l])}),s);return{current:async()=>{i.type="weather";const s=await w(p,y,_,i);i.type="forecast";const d=await w(p,y,_,i),c=L(d,[h()]);c[0].max<s.main.temp&&(c[0].max=s.main.temp);let u=o(s);return u=n([u],c),u},forecast:async()=>{i.type="forecast";const s=await w(p,y,_,i),d=b(h(3,12),s.list),c=L(s,h(3)),u=D(s,h(3));let l=[];return d.forEach(f=>l.push(o(f,!0))),l=n(l,c,u),l}}},v=async()=>{let e=!1;const t={units:"metric",symbol:{metric:"°C",imperial:"°F",humidity:"%"}},a=(r,m)=>{r.units==="metric"?r.units="imperial":t.units="metric",document.querySelector(".unit-selection__button").innerHTML=r.symbol[r.units],e&&m()},i=(r,m)=>{const s=async(c,u)=>{const l=new Image;return l.src=`https://openweathermap.org/img/wn/${c}@${u}x.png`,await l.decode(),l.src},d=async(c,u)=>{const l=document.querySelector(`.weather__info.${u}`),f=$=>`${q($)}${t.symbol[t.units]}`;let g=2;l.querySelector(".weather__info__text__temp-max").innerHTML='<i class="fa-solid fa-caret-up"></i> '+f(c.details.tempMax),l.querySelector(".weather__info__text__temp-low").innerHTML='<i class="fa-solid fa-caret-down"></i> '+f(c.details.tempMin),l.querySelector(".weather__info__text__humidity").innerHTML='<i class="fa-solid fa-droplet"></i> '+c.details.humidity+t.symbol.humidity,u==="current"?(g=4,l.querySelector(".weather__info__text__temp").innerHTML=f(c.details.temp),l.querySelector(".weather__info__desc__weather").innerHTML=c.weather.state,l.querySelector(".weather__info__desc__img").src=await s(c.weather.icon,g)):(l.querySelector(".weather__info__day").innerHTML=c.date,l.querySelector(".weather__info__img").src=await s(c.weather.icon,g))};d(r,"current"),m.forEach((c,u)=>d(c,`day${u+1}`)),document.querySelector(".weather__container").style.display="grid"},o=r=>{document.querySelector(".location-search__input").value=`${r.name}, ${r.state}`},n=async()=>{const r=await W(),m=await M(r.lat,r.lon,t).current(),s=await M(r.lat,r.lon,t).forecast();m.length>0&&s.length>0?(o(r),i(...m,s),e=!0):console.log("Weather data could not be retrieved!")};O(()=>a(t,n)),E(n)};v();
